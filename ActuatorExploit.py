# -*- coding: utf-8 -*-
'''
@Time : 2021/10/16 16:11
@Author : Seals6
@File : ActuatorExploit.py
@contact: 972480239@qq.com
@blog: blog.seals6.top
'''
import argparse
import requests
import urllib3
#在https情况下移除警告信息
from urllib3.exceptions import InsecureRequestWarning
urllib3.disable_warnings(InsecureRequestWarning)


def Index():
    Banner ='''\033[31;1m
      ___       _               _             _____           _       _ _   
     / _ \     | |             | |           |  ___|         | |     (_) |  
    / /_\ \ ___| |_ _   _  __ _| |_ ___  _ __| |____  ___ __ | | ___  _| |_ 
    |  _  |/ __| __| | | |/ _` | __/ _ \| '__|  __\ \/ / '_ \| |/ _ \| | __|
    | | | | (__| |_| |_| | (_| | || (_) | |  | |___>  <| |_) | | (_) | | |_ 
    \_| |_/\___|\__|\__,_|\__,_|\__\___/|_|  \____/_/\_\ .__/|_|\___/|_|\__|
                                                       | |                 
                                                       |_|    
                                                       \033[31;0m
                                                       \033[32;1mAuthor: Seals6\033[0m              
    '''
    print(Banner)



def Check(target):
    print("[+]-----检测未授权漏洞中-----")
    lis = [line.strip() for line in open('./Dic/SpringBoot-Dic', 'r')]
    url= target
    for i in lis:
        headers = {
            'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Safari/537.36 QIHU 360SE'
        }
        res=requests.get(url=url+i,headers=headers,verify=False)
        # print(res)
        if res.status_code == 200:
            print("[+]"+url+i+"可能存在信息泄漏")

# def Exploit():


if __name__ == '__main__':
    parser = argparse.ArgumentParser(description="Springboot ActuatorExploit")
    parser.add_argument('-w', '--way', type=str, help="Scan/Exploit the target ")
    parser.add_argument('-t', '--target', type=str, required=True, help="Target url like http://127.0.0.1:8080")
    args = parser.parse_args()

    Index()

    if args.way == "scan":
        Check(args.target)